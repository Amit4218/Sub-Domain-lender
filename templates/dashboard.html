{% extends "base.html" %} {% block content %}

<div class="w-full px-6 py-6">
  <div id="modal-overlay" class="hidden fixed inset-0 bg-black/50 z-40"></div>

  <div class="flex items-center justify-between mb-6">
    <h1 class="text-xl font-semibold text-gray-800">Records Created By You!</h1>
    <h3 class="text-md font-semibold text-gray-800">
      <strong class="text-xl">Note:</strong>
      <span class="underline text-zinc-900 text-">amit4218.fun</span> will be
      the base domain.
    </h3>

    <div class="flex items-center gap-3">
      <form method="POST" action="/logout">
        <button
          type="submit"
          class="inline-flex items-center bg-red-600 text-white px-4 py-2 rounded-lg shadow hover:bg-red-700 transition"
        >
          Logout
        </button>
      </form>

      <button
        id="show-form"
        class="inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition"
      >
        <span class="text-lg leading-none">+</span>
        Add Record
      </button>
    </div>
  </div>

  {% if error %}
  <div
    id="error"
    class="mb-6 p-4 bg-red-50 border-l-4 border-red-500 rounded-lg shadow-sm"
  >
    <div class="flex items-start gap-3">
      <svg
        class="w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          fill-rule="evenodd"
          d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
          clip-rule="evenodd"
        />
      </svg>
      <p class="text-sm text-red-700 font-medium">{{ error }}</p>
    </div>
  </div>
  {% endif %}

  <div class="overflow-x-auto bg-white rounded-xl shadow-md">
    <table class="min-w-full border border-gray-200">
      <thead class="bg-gray-100 text-gray-700 text-sm uppercase">
        <tr>
          <th class="px-4 py-3 text-left">Name</th>
          <th class="px-4 py-3 text-left">Type</th>
          <th class="px-4 py-3 text-left">Content</th>
          <th class="px-4 py-3 text-left">Created</th>
          <th class="px-4 py-3 text-center">Actions</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-200 text-sm">
        {% for record in records %}
        <tr class="hover:bg-gray-50">
          <td class="px-4 py-3 font-medium text-gray-900">{{ record.name }}</td>

          <td class="px-4 py-3">
            <span
              class="inline-flex px-2 py-1 rounded bg-blue-100 text-blue-700 font-semibold"
            >
              {{ record.record_type }}
            </span>
          </td>

          <td class="px-4 py-3 text-gray-700">{{ record.points_to }}</td>

          <td class="px-4 py-3 text-gray-500">
            {{ record.created_at.strftime('%Y-%m-%d %H:%M') }}
          </td>

          <td class="px-4 py-3 text-center">
            <form
              action="/delete-record/{{ record.id }}"
              method="POST"
              onsubmit="return confirm('Delete this DNS record?');"
            >
              <button
                type="submit"
                class="px-3 py-1 rounded bg-red-500 text-white hover:bg-red-600 transition"
              >
                Delete
              </button>
            </form>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="5" class="px-4 py-6 text-center text-gray-500">
            No DNS records found. <br />
            <span>Click add record to add one now.</span>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<form
  id="add-record-form"
  class="hidden fixed inset-0 m-auto bg-white w-full max-w-lg rounded-xl shadow-lg p-6 space-y-5 z-50 h-fit"
  action="/add-record"
  method="POST"
>
  <div class="flex items-center justify-between">
    <h2 class="text-xl font-semibold text-gray-800">DNS Record Form</h2>
    <button
      type="button"
      id="close-form"
      class="h-8 w-8 flex items-center justify-center rounded-full text-gray-500 hover:bg-red-500 hover:text-white transition"
      aria-label="Close"
    >
      âœ•
    </button>
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">
      Record Type <span class="text-red-600">*</span>
    </label>
    <select
      name="type"
      required
      class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500"
    >
      <option value="">Select record type</option>
      <option>A</option>
      <option>AAAA</option>
      <option>CNAME</option>
      <option>MX</option>
    </select>
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">
      Host / Name <span class="text-red-600">*</span>
    </label>
    <input
      name="name"
      type="text"
      required
      placeholder="e.g. www"
      class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500"
    />
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">
      Value / Target <span class="text-red-600">*</span>
    </label>
    <input
      name="content"
      type="text"
      required
      placeholder="e.g. 192.168.1.1"
      class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500"
    />
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1"> TTL </label>
    <input
      type="number"
      name="ttl"
      value="3600"
      min="60"
      class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500"
    />
  </div>

  <button
    type="submit"
    class="w-full bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 transition"
  >
    Save Record
  </button>
</form>

{% endblock content %}
